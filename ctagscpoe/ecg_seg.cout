cscope 15 $HOME/Documents/SelfStudy/Code/Code_Of_Android_ECG_SEG -q 0000000305 0000029728
	@inc/ecg_seg_def.h

1 #i‚de‡
__ECG_SEG_DEF_H__


2 
	#__ECG_SEG_DEF_H__


	)

4 
	#ECG_SEG_ENCODER_CONVRELU_1_K_L
 (9)

	)

5 
	#ECG_SEG_ENCODER_CONVRELU_1_K_C
 (4)

	)

6 
	#ECG_SEG_ENCODER_CONVRELU_1_K_DUMMING_PAD
 (4)

	)

7 
	#ECG_SEG_ENCODER_CONVRELU_1_K_DUMMING_STRIDE
 (1)

	)

9 
	#ECG_TEST_SIGNAL_ORI_C
 (1)

	)

10 
	#ECG_TEST_SIGNAL_ORI_L
 (2000)

	)

11 
	#ECG_TEST_SIGNAL_K_L
 (9)

	)

12 
	#ECG_TEST_SIGNAL_PADDING
 (4)

	)

13 
	#ECG_TEST_SIGNAL_STRIDE
 (1)

	)

14 
	#ECG_TEST_SIGNAL_MAX_OUT_L
 (2000)

	)

15 
	#ECG_TEST_SIGNAL_MAX_K_L
 (9)

	)

17 
	#ECG_TINY_TEST_SIGNAL_ORI_C
 (1)

	)

18 
	#ECG_TINY_TEST_SIGNAL_ORI_L
 (9)

	)

19 
	#ECG_TINY_TEST_SIGNAL_K_L
 (9)

	)

20 
	#ECG_TINY_TEST_SIGNAL_PADDING
 (4)

	)

21 
	#ECG_TINY_TEST_SIGNAL_STRIDE
 (1)

	)

22 
	#ECG_TINY_TEST_SIGNAL_MAX_OUT_L
 (9)

	)

23 
	#ECG_TINY_TEST_SIGNAL_MAX_K_L
 (9)

	)

25 
	#ECG_SIGNAL_ORI_C
 (
ECG_TINY_TEST_SIGNAL_ORI_C
)

	)

26 
	#ECG_SIGNAL_ORI_L
 (
ECG_TINY_TEST_SIGNAL_ORI_L
)

	)

27 
	#ECG_SIGNAL_K_L
 (
ECG_TINY_TEST_SIGNAL_K_L
)

	)

28 
	#ECG_SIGNAL_PADDING
 (
ECG_TINY_TEST_SIGNAL_PADDING
)

	)

29 
	#ECG_SIGNAL_STRIDE
 (
ECG_TINY_TEST_SIGNAL_STRIDE
)

	)

31 
	#ECG_SIG2COL_MAX_OUT_L
 (
ECG_TINY_TEST_SIGNAL_MAX_OUT_L
)

	)

32 
	#ECG_SIG2COL_MAX_K_L
 (
ECG_TINY_TEST_SIGNAL_MAX_K_L
)

	)

	@inc/ecg_seg_matrix.h

1 #i‚de‡
__ECG_SEG_MATRIX_H__


2 
	#__ECG_SEG_MATRIX_H__


	)

3 
	~<°döt.h
>

5 
	~"¨m_utû.h
"

6 
	~"¨m_ty≥def.h
"

8 #ifde‡
MATRIX_DBG


9 
	#MATRIX_FUNC_ENTRANCE
 
FUNC_ENTRANCE_LOG


	)

10 
	#MATRIX_FUNC_EXIT
 
FUNC_EXIT_LOG


	)

11 
	#MATRIX_PRINTF
(
x
...Ë
	`ªe_¥ötf
(
LOG_DEBUG
, x)

	)

12 
	#MATRIX_LOG
 
LOG_DEBUG


	)

14 
	#MATRIX_FUNC_ENTRANCE
 dÿ{} 0)

	)

15 
	#MATRIX_FUNC_EXIT
 dÿ{} 0)

	)

16 
	#MATRIX_PRINTF
(
x
...Ëdÿ{} 0)

	)

17 
	#MATRIX_LOG
 
LOG_VERBOSE


	)

20 
	#FP_PACK_SIZE
 (4)

	)

21 
	#FP_PACK_ELE
 (16)

	)

23 
	#ELE_U8_SIZE
 (
uöt8_t
)

	)

24 
	#ELE_U16_SIZE
 (
uöt16_t
)

	)

25 
	#ELE_U32_SIZE
 (
uöt32_t
)

	)

26 
	#ELE_FP_SIZE
 ()

	)

28 
	eö_fûe_ty≥
 {

29 
	mIN_FILE_U8
 = 0,

30 
	mIN_FILE_U16
 = 1,

31 
	mIN_FILE_U32
 = 2,

32 
	mIN_FILE_FP
 = 3,

33 } 
	tö_fûe_ty≥_t
;

35 
	em©_ty≥
 {

36 
	mMAT_U8
 = 0,

37 
	mMAT_U16
 = 1,

38 
	mMAT_U32
 = 2,

39 
	mMAT_FP
 = 3,

40 } 
	tm©_ty≥_t
;

42 
	e∑ck_m©
 {

43 
	mPACK_MAT_ORI
 = 0,

44 
	mPACK_MAT_COL
 = 1,

45 } 
	t∑ck_m©_t
;

47 
	sm©_sig_∑ø
 {

48 
uöt32_t
 
	m‹i_l
;

49 
uöt32_t
 
	mk_l
;

50 
uöt32_t
 
	m∑ddög
;

51 
uöt32_t
 
	m°ride
;

52 } 
	tm©_sig_∑ø_t
;

54 
	sm©_sig
 {

55 
uöt32_t
 
	m‹i_l
;

56 
uöt32_t
 
	mout_l
;

57 
uöt32_t
 
	mcﬁ_h
;

58 
uöt32_t
 
	mcﬁ_w
;

59 
uöt32_t
 
	m∑ck_w_°ï
;

60 
uöt32_t
 
	m∑ck_h
;

61 
uöt32_t
 
	m∑ck_w
;

62 
uöt32_t
 
	m∑ck_ñe
;

63 
uöt32_t
 
	m∑ddög
;

64 
uöt32_t
 
	m°ride
;

65 
uöt32_t
 
	mÆloc_cﬁ
;

66 *
	m‹i_buf
;

67 } 
	tm©_sig_t
;

69 
öt32_t
 
m©_sig_c⁄°ru˘‹_Â_°
(
m©_sig_∑ø_t
 *
p_∑øm
,

70 
m©_sig_t
 *
p_m©
);

72 
öt32_t
 
m©_sig_c⁄°ru˘‹_Â_f›í
(
m©_sig_∑ø_t
 *
p_∑øm
,

73 
m©_sig_t
 *
p_m©
,

74 *
∑th
,

75 
BOOL
 
Æloc_cﬁ
);

76 
öt32_t
 
m©_sig_c⁄°ru˘‹_Â_f›í_v2
(
m©_sig_∑ø_t
 *
p_∑øm
,

77 
m©_sig_t
 *
p_m©
,

78 *
∑th
,

79 
BOOL
 
kî√l
);

80 
m©_sig_de°ru˘‹
(
m©_sig_t
 *
p_m©
);

	@inc/ecg_seg_model.h

1 #i‚de‡
__ECG_SEG_MODEL_H__


2 
	#__ECG_SEG_MODEL_H__


	)

4 
	~<°döt.h
>

6 
	~"¨m_utû.h
"

7 
	~"¨m_ty≥def.h
"

8 
	~"ecg_£g_m©rix.h
"

10 #ifde‡
MODEL_DBG


11 
	#MODEL_FUNC_ENTRANCE
 
FUNC_ENTANGE_LOG


	)

12 
	#MODEL_FUNC_EXIT
 
FUNC_EXIT_LOG


	)

13 
	#MODEL_PRINTF
(
x
...Ë
	`ªe_¥ötf
(
LOG_DEBUG
, x)

	)

14 
	#MODEL_LOG
 
LOG_DEBUG


	)

16 
	#MODEL_FUNC_ENTRANCE
 dÿ{} 0)

	)

17 
	#MODEL_FUNC_EXIT
 dÿ{} 0)

	)

18 
	#MODEL_PRINTF
(
x
...Ëdÿ{} 0)

	)

19 
	#MODEL_LOG
 
LOG_VERBOSE


	)

22 
	#UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT0
 "./modñ_weight/u√t_ícodî1_c⁄v1d_block_1_c⁄v_weight0.bö"

	)

23 
	#UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT1
 "./modñ_weight/u√t_ícodî1_c⁄v1d_block_1_c⁄v_weight1.bö"

	)

24 
	#UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT2
 "./modñ_weight/u√t_ícodî1_c⁄v1d_block_1_c⁄v_weight2.bö"

	)

25 
	#UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT3
 "./modñ_weight/u√t_ícodî1_c⁄v1d_block_1_c⁄v_weight3.bö"

	)

27 
	sc⁄v_fu£_ªlu


29 
m©_sig_∑ø_t
 
	mweight_∑ø
;

30 
m©_sig_t
 
	mc⁄v_weight
[4];

31 
m©_sig_t
 
	mc⁄v_büs
[4];

32 } 
	tc⁄v_fu£_ªlu_t
;

34 
öt32_t
 
c⁄v_fu£_ªlu_c⁄°ru˘‹_f›í
(
m©_sig_∑ø_t
 *
p_∑ø
,

35 
c⁄v_fu£_ªlu_t
 **
µ_moduÀ
,

36 *
∑th0
, *
∑th1
, *
∑th2
, *
∑th3
);

38 
c⁄v_fu£_ªlu_de°ru˘‹
(
c⁄v_fu£_ªlu_t
 *
p_moduÀ
);

	@inc/ecg_seg_sig2col.h

1 #i‚de‡
__ECG_SEG_SIG2COL_H__


2 
	#__ECG_SEG_SIG2COL_H__


	)

3 
	~<°döt.h
>

4 
	~<limôs.h
>

5 
	~"¨m_ty≥def.h
"

6 
	~"¨m_utû.h
"

7 
	~"ecg_£g_m©rix.h
"

8 
	~"ecg_ª•⁄£_def.h
"

9 
	~"ecg_£g_utû.h
"

11 #ifde‡
EN_SIG2COL_DBG


12 
	#SIG2COL_FUNC_ENTRANCE
 
FUNC_ENTRANCE_LOG


	)

13 
	#SIG2COL_FUNC_EXIT
 
FUNC_EXIT_LOG


	)

14 
	#SIG2COL_PRINTF
(
x
...Ë
	`ªe_¥ötf
(
LOG_DEBUG
, x)

	)

15 
	#SIG2COL_LOG
 
LOG_DEBUG


	)

17 
	#SIG2COL_FUNC_ENTRANCE
 dÿ{} 0)

	)

18 
	#SIG2COL_FUNC_EXIT
 dÿ{} 0)

	)

19 
	#SIG2COL_PRINTF
(
x
...Ëdÿ{} 0)

	)

20 
	#SIG2COL_LOG
 
LOG_VERBOSE


	)

23 
	#SIG2COL_INVALID_IND
 (
INT_MIN
)

	)

25 
	ssig2cﬁ_˘r
 {

26 
uöt32_t
 
	mcur_out_l
;

27 
uöt32_t
 
	mcur_out_∑ck_l
;

28 
uöt32_t
 
	mcur_k_l
;

29 
uöt32_t
 
	mcur_ñe_num
;

30 
uöt32_t
 
	mmax_out_l
;

31 
uöt32_t
 
	mmax_out_∑ck_l
;

32 
uöt32_t
 
	mmax_k_l
;

33 
uöt32_t
 
	mmax_ñe_num
;

34 *
	mcﬁ_buf
;

35 } 
	tsig2cﬁ_˘r_t
;

37 
öt32_t
 
sig2cﬁ_˘r_Â_c⁄°ru˘‹
(
uöt32_t
 
max_out_l
, uöt32_à
max_k_l
, 
sig2cﬁ_˘r_t
 **
µ_˘r
);

38 
öt32_t
 
sig2cﬁ_m©_Â
(
sig2cﬁ_˘r_t
 *
p_˘r
, 
m©_sig_t
 *
p_m©
);

39 
sig2cﬁ_¥ötf_m©_Â
(
sig2cﬁ_˘r_t
 *
p_˘r
);

40 
sig2cﬁ_˘r_de°ru˘‹
(
sig2cﬁ_˘r_t
 *
p_˘r
);

	@inc/ecg_seg_signal.h

1 #i‚de‡
__ECG_SEG_SIGNAL_H__


2 
	#__ECG_SEG_SIGNAL_H__


	)

4 
	~<°döt.h
>

6 
	~"¨m_utû.h
"

7 
	~"¨m_ty≥def.h
"

8 
	~"ecg_£g_m©rix.h
"

10 #ifde‡
SIGNAL_DBG


11 
	#SIGNAL_FUNC_ENTRANCE
 
FUNC_ENTRANCE_LOG


	)

12 
	#SIGNAL_FUNC_EXIT
 
FUNC_EXIT_LOG


	)

13 
	#SIGNAL_PRINTF
(
x
...Ë
	`ªe_¥ötf
(
LOG_DEBUG
, x)

	)

14 
	#SIGNAL_LOG
 
LOG_DEBUG


	)

16 
	#SIGNAL_FUNC_ENTRANCE
 dÿ{} 0)

	)

17 
	#SIGNAL_FUNC_EXIT
 dÿ{} 0)

	)

18 
	#SIGNAL_PRINTF
(
x
...Ëdÿ{} 0)

	)

19 
	#SIGNAL_LOG
 
LOG_VERBOSE


	)

22 
	#ECG_SIGNAL
 "./d©a/ã°_sig«l.bö"

	)

23 
	#ECG_TINY_SIGNAL
 "./d©a/ã°_töy_sig«l.bö"

	)

25 
	ssig«l_c⁄èöî
 {

26 
uöt32_t
 
	msig«l_num
;

27 
m©_sig_∑ø_t
 
	msig«l_∑ø
;

28 
m©_sig_t
 *
	msig«l
;

29 } 
	tsig«l_c⁄èöî_t
;

31 
öt32_t
 
sig«l_c⁄èöî_c⁄°ru˘‹_Â_f›í
(
uöt32_t
 
sig«l_num
,

32 
m©_sig_∑ø_t
 *
p_∑ø
,

33 
sig«l_c⁄èöî_t
 **
µ_c⁄èöî
,

34 **
sig«l_∑th
);

36 
sig«l_c⁄èöî_de°ru˘‹
(
sig«l_c⁄èöî_t
 *
p_c⁄èöî
);

	@src/ecg_seg_main.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

5 
	~"¨m_utû.h
"

6 
	~"ecg_£g_def.h
"

7 
	~"ecg_£g_m©rix.h
"

8 
	~"ecg_£g_modñ.h
"

9 
	~"ecg_£g_sig2cﬁ.h
"

10 
	~"ecg_£g_sig«l.h
"

11 
	~"ecg_ª•⁄£_def.h
"

12 
	~"ecg_£g_utû.h
"

14 
	$maö
(
¨gc
, * 
¨gv
[])

16 
	`ªe_log
(
LOG_DEBUG
, "%†°¨ts", 
__func__
);

17 
öt32_t
 
ªtvÆ
 = 
ECG_SEG_OK
;

18 **
sig«l_∑th
 = 
NULL
;

19 
c⁄v_fu£_ªlu_t
 *
p_moduÀ
 = 
NULL
;

20 
sig«l_c⁄èöî_t
 *
p_sig«l
 = 
NULL
;

21 
sig2cﬁ_˘r_t
 *
p_sig2cﬁ_˘r
 = 
NULL
;

23 
sig«l_∑th
 = 
	`ªe_mÆloc
((*));

24 
sig«l_∑th
[0] = 
	`ªe_mÆloc
(()*
ECG_SEG_PATH_MAX
);

25 
	`•rötf
(
sig«l_∑th
[0], "%s", 
ECG_TINY_SIGNAL
);

26 
	`ªe_log
(
LOG_DEBUG
, "%†∑th %s", 
__func__
, 
sig«l_∑th
[0]);

28 
m©_sig_∑ø_t
 
weight_∑ø
 = {.
‹i_l
 = 9,

29 .
k_l
 = 9,

30 .
∑ddög
 = 4,

31 .
°ride
 = 1,};

32 
m©_sig_∑ø_t
 
sig«l_∑ø
 = {.
‹i_l
 = 9,

33 .
k_l
 = 9,

34 .
∑ddög
 = 4,

35 .
°ride
 = 1,};

37 
	`c⁄v_fu£_ªlu_c⁄°ru˘‹_f›í
(&
weight_∑ø
, &
p_moduÀ
,

38 
UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT0
,

39 
UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT1
,

40 
UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT2
,

41 
UNET_ENCODER1_CONV1D_BLOCK_1_CONV_WEIGHT3
);

42 
ªtvÆ
 = 
	`sig«l_c⁄èöî_c⁄°ru˘‹_Â_f›í
(1, &
sig«l_∑ø
,

43 &
p_sig«l
,

44 
sig«l_∑th
);

45 
ªtvÆ
 = 
	`sig2cﬁ_˘r_Â_c⁄°ru˘‹
(9, 9, &
p_sig2cﬁ_˘r
);

46 
ªtvÆ
 = 
	`sig2cﬁ_m©_Â
(
p_sig2cﬁ_˘r
, 
p_sig«l
->
sig«l
);

47 
	`ªe_log
(
LOG_DEBUG
, "%†íds", 
__func__
);

48 
	`c⁄v_fu£_ªlu_de°ru˘‹
(
p_moduÀ
);

49 
	`sig«l_c⁄èöî_de°ru˘‹
(
p_sig«l
);

50 
	`sig2cﬁ_˘r_de°ru˘‹
(
p_sig2cﬁ_˘r
);

51 
	`ªe_‰ì
(
p_moduÀ
);

52 
	`ªe_‰ì
(
p_sig«l
);

53 
	`ªe_‰ì
(
p_sig2cﬁ_˘r
);

54 
	`ªe_‰ì
(
sig«l_∑th
[0]);

55 
	`ªe_‰ì
(
sig«l_∑th
);

57 
	}
}

	@src/ecg_seg_matrix.c

1 
	~<°dlib.h
>

2 
	~<°rög.h
>

4 
	~"¨m_utû.h
"

5 
	~"¨m_ty≥def.h
"

6 
	~"ecg_ª•⁄£_def.h
"

7 
	~"ecg_£g_m©rix.h
"

9 
	$m©_sig_Â_f›í
(*
p_m©
, *
∑th
)

11 
MATRIX_FUNC_ENTRANCE
;

12 
size_t
 
fûe_size
 = 0, 
ªad_size
;

13 
FILE
 *
m©_fûe
 = 
NULL
;

14 
	`ªe_check_nuŒ_exô
(
p_m©
, 
EXIT_MAT_SIG_FP_FOPEN
, "%†occur†îr‹ duêtÿp_m© i†NULL", 
__func__
);

15 
	`ªe_check_nuŒ_exô
(
∑th
, 
EXIT_MAT_SIG_FP_FOPEN
, "%†occur†îr‹ duêtÿ∑th i†NULL", 
__func__
);

16 
	`ªe_check_f›í
(
m©_fûe
, 
∑th
, "rb", 
EXIT_MAT_SIG_FP_FOPEN
);

17 
	`ªe_fûe_size
(
fûe_size
, 
m©_fûe
);

18 
	`ªe_log
(
MATRIX_LOG
, "%†fûe_sizê%lu", 
__func__
, 
fûe_size
);

19 
	`ªe_check_f›í
(
m©_fûe
, 
∑th
, "rb", 
EXIT_MAT_SIG_FP_FOPEN
);

20 
	`ªe_fûe_ªad
(
m©_fûe
, 
p_m©
, 
fûe_size
, 
ªad_size
);

21 
EXIT_MAT_SIG_FP_FOPEN
:

22 
MATRIX_FUNC_EXIT
;

23 
	}
}

25 
	$¥öt_m©_sig_∑ø
(
m©_sig_∑ø_t
 *
p_∑øm
)

27 
MATRIX_FUNC_ENTRANCE
;

28 
	`MATRIX_PRINTF
("%†p_∑øm->‹i_»%d\n", 
__func__
, 
p_∑øm
->
‹i_l
);

29 
	`MATRIX_PRINTF
("%†p_∑øm->k_»%d\n", 
__func__
, 
p_∑øm
->
k_l
);

30 
	`MATRIX_PRINTF
("%†p_∑øm->∑ddög %d\n", 
__func__
, 
p_∑øm
->
∑ddög
);

31 
	`MATRIX_PRINTF
("%†p_∑øm->°ridê%d\n", 
__func__
, 
p_∑øm
->
°ride
);

32 
MATRIX_FUNC_EXIT
;

33 
	}
}

35 
	$¥öt_m©_∑ø
(
m©_sig_t
 *
p_m©
)

37 
MATRIX_FUNC_ENTRANCE
;

38 
	`MATRIX_PRINTF
("%†p_m©->‹i_»%d\n", 
__func__
, 
p_m©
->
‹i_l
);

39 
	`MATRIX_PRINTF
("%†p_m©->out_»%d\n", 
__func__
, 
p_m©
->
out_l
);

40 
	`MATRIX_PRINTF
("%†p_m©->cﬁ_h %d\n", 
__func__
, 
p_m©
->
cﬁ_h
);

41 
	`MATRIX_PRINTF
("%†p_m©->cﬁ_w %d\n", 
__func__
, 
p_m©
->
cﬁ_w
);

42 
	`MATRIX_PRINTF
("%†p_m©->∑ck_w_°ï %d\n", 
__func__
, 
p_m©
->
∑ck_w_°ï
);

43 
	`MATRIX_PRINTF
("%†p_m©->∑ck_h %d\n", 
__func__
, 
p_m©
->
∑ck_h
);

44 
	`MATRIX_PRINTF
("%†p_m©->∑ck_w %d\n", 
__func__
, 
p_m©
->
∑ck_w
);

45 
	`MATRIX_PRINTF
("%†p_m©->∑ck_ñê%d\n", 
__func__
, 
p_m©
->
∑ck_ñe
);

46 
	`MATRIX_PRINTF
("%†p_m©->∑ddög %d\n", 
__func__
, 
p_m©
->
∑ddög
);

47 
	`MATRIX_PRINTF
("%†p_m©->°ridê%d\n", 
__func__
, 
p_m©
->
°ride
);

48 
MATRIX_FUNC_EXIT
;

49 
	}
}

51 
	$¥öt_m©_‹i_Â
(
m©_sig_t
 *
p_m©
)

53 
MATRIX_FUNC_ENTRANCE
;

54 
	`ªe_check_nuŒ_exô
(
p_m©
, 
EXIT_PRINT_MAT_ORI_FP
, "%†occur†îr‹ duêtÿp_m© i†NULL", 
__func__
);

55 *
p_ñe
 = 
NULL
;

56 
	`MATRIX_PRINTF
("%†p_m©->‹i_»%d\n", 
__func__
, 
p_m©
->
‹i_l
);

57 
	`ªe_check_nuŒ_exô
(
p_m©
->
‹i_buf
, 
EXIT_PRINT_MAT_ORI_FP
, "%†occur†îr‹ duêtÿp_m©->‹i_bu‡i†NULL", 
__func__
);

58 
p_ñe
 = 
p_m©
->
‹i_buf
;

59 
uöt32_t
 
i
 = 0; i<
p_m©
->
‹i_l
; i++)

61 
	`MATRIX_PRINTF
("%3.05‡", *
p_ñe
);

62 
p_ñe
++;

64 
	`MATRIX_PRINTF
("\n");

65 
EXIT_PRINT_MAT_ORI_FP
:

66 
MATRIX_FUNC_EXIT
;

67 
	}
}

69 
öt32_t
 
	$m©_sig_c⁄°ru˘‹_Â_f›í
(
m©_sig_∑ø_t
 *
p_∑øm
,

70 
m©_sig_t
 *
p_m©
,

71 *
∑th
,

72 
BOOL
 
kî√l
)

74 
MATRIX_FUNC_ENTRANCE
;

75 
uöt32_t
 
ñe_num
 = 0;

76 
öt32_t
 
ªtvÆ
 = 
ECG_SEG_OK
;

77 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_∑øm
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_MAT_SIG_CONSTRUCTOR_FP_FOPEN
,

78 "%†occur†îr‹ duêtÿp_∑øm i†NULL", 
__func__
);

79 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_m©
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_MAT_SIG_CONSTRUCTOR_FP_FOPEN
,

80 "%†occur†îr‹ duêtÿp_m© i†NULL", 
__func__
);

81 
	`ªe_check_nuŒ_exô_ªtvÆ
(
∑th
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_MAT_SIG_CONSTRUCTOR_FP_FOPEN
,

82 "%†occur†îr‹ duêtÿ∑th i†NULL", 
__func__
);

83 
	`ªe_log
(
MATRIX_LOG
, "%†kî√»%d", 
__func__
, 
kî√l
);

84 
	`¥öt_m©_sig_∑ø
(
p_∑øm
);

86 i‡(
kî√l
)

88 
p_m©
->
‹i_l
 = 
p_∑øm
->ori_l;

89 
p_m©
->
out_l
 = 
p_∑øm
->
‹i_l
;

90 
p_m©
->
∑ck_w_°ï
 =Ö_m©->
out_l
 / 
FP_PACK_SIZE
 + 1;

91 
p_m©
->
∑ck_h
 = 1;

94 
p_m©
->
‹i_l
 = 
p_∑øm
->ori_l;

95 
p_m©
->
out_l
 = (
p_∑øm
->
‹i_l
+2*p_∑øm->
∑ddög
-p_∑øm->
k_l
)/p_∑øm->
°ride
+1;

96 
p_m©
->
cﬁ_h
 = 
p_∑øm
->
k_l
;

97 
p_m©
->
cﬁ_w
 =Ö_m©->
out_l
;

98 
p_m©
->
∑ck_w_°ï
 =Ö_m©->
out_l
 / 
FP_PACK_SIZE
 + 1;

99 
p_m©
->
∑ck_h
 =Ö_m©->
cﬁ_h
;

101 
p_m©
->
∑ck_w
 =Ö_m©->
∑ck_w_°ï
 * 
FP_PACK_SIZE
;

102 
p_m©
->
∑ck_ñe
 =Ö_m©->
∑ck_h
 *Ö_m©->
∑ck_w
;

103 
p_m©
->
∑ddög
 = 
p_∑øm
->padding;

104 
p_m©
->
°ride
 = 
p_∑øm
->stride;

105 
	`¥öt_m©_∑ø
(
p_m©
);

106 i‡(
kî√l
)

108 
ñe_num
 = 
p_m©
->
∑ck_ñe
;

109 
	`ªe_log
(
MATRIX_LOG
, "%†¥ï¨e†tÿÆloˇã kî√»buf„r", 
__func__
);

112 
ñe_num
 = 
p_m©
->
‹i_l
;

113 
	`ªe_log
(
MATRIX_LOG
, "%†¥ï¨e†tÿÆloˇã sig«»buf„r", 
__func__
);

115 
	`ªe_log
(
MATRIX_LOG
, "%†¥ï¨e†tÿÆloˇã %d * ELE_FP_SIZE", 
__func__
, 
ñe_num
);

116 
p_m©
->
‹i_buf
 = 
	`ªe_mÆloc
(
ñe_num
*
ELE_FP_SIZE
);

117 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_m©
->
‹i_buf
, 
ªtvÆ
, 
ECG_SEG_ALLOC_FAILED
, 
EXIT_MAT_SIG_CONSTRUCTOR_FP_FOPEN
,

118 "%†occur†îr‹ duêtÿÆloˇãÖ_m©->‹i_bu‡Áûed", 
__func__
);

119 
	`ªe_£t
(
p_m©
->
‹i_buf
, 0, 
ñe_num
*
ELE_FP_SIZE
);

120 
	`m©_sig_Â_f›í
(
p_m©
->
‹i_buf
, 
∑th
);

121 
	`¥öt_m©_‹i_Â
(
p_m©
);

122 
EXIT_MAT_SIG_CONSTRUCTOR_FP_FOPEN
:

123 
MATRIX_FUNC_EXIT
;

124  
ªtvÆ
;

125 
	}
}

127 
	$m©_sig_de°ru˘‹
(
m©_sig_t
 *
p_m©
)

129 
	`ªe_‰ì
(
p_m©
->
‹i_buf
);

130 
	}
}

	@src/ecg_seg_model.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

5 
	~"¨m_utû.h
"

6 
	~"¨m_ty≥def.h
"

7 
	~"ecg_£g_m©rix.h
"

8 
	~"ecg_£g_modñ.h
"

9 
	~"ecg_ª•⁄£_def.h
"

11 
öt32_t
 
	$c⁄v_fu£_ªlu_c⁄°ru˘‹_f›í
(
m©_sig_∑ø_t
 *
p_∑ø
,

12 
c⁄v_fu£_ªlu_t
 **
µ_moduÀ
,

13 *
∑th0
, *
∑th1
, *
∑th2
, *
∑th3
)

15 
MODEL_FUNC_ENTRANCE
;

16 
öt32_t
 
ªtvÆ
 = 
ECG_SEG_OK
;

17 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_∑ø
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
,

18 "%†occur†îr‹ duêtÿp_∑ø i†NULL", 
__func__
);

19 
	`ªe_check_nuŒ_exô_ªtvÆ
(
µ_moduÀ
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
,

20 "%†occur†îr‹ duêtÿµ_moduÀ i†NULL", 
__func__
);

21 *
µ_moduÀ
 = 
	`ªe_mÆloc
((
c⁄v_fu£_ªlu_t
));

22 
	`ªe_£t
(*
µ_moduÀ
, 0, (
c⁄v_fu£_ªlu_t
));

23 
ªtvÆ
 |
	`m©_sig_c⁄°ru˘‹_Â_f›í
(
p_∑ø
,

24 &(*
µ_moduÀ
)->
c⁄v_weight
[0],

25 
∑th0
,

26 
TRUE
);

27 
	`ªe_check_åue_exô
((
ªtvÆ
 !
ECG_SEG_OK
), 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
, "%†occur†îr‹ whí c⁄°ru˘†weight0", 
__func__
);

28 
ªtvÆ
 |
	`m©_sig_c⁄°ru˘‹_Â_f›í
(
p_∑ø
,

29 &(*
µ_moduÀ
)->
c⁄v_weight
[1],

30 
∑th1
,

31 
TRUE
);

32 
	`ªe_check_åue_exô
((
ªtvÆ
 !
ECG_SEG_OK
), 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
, "%†occur†îr‹ whí c⁄°ru˘†weight1", 
__func__
);

33 
ªtvÆ
 |
	`m©_sig_c⁄°ru˘‹_Â_f›í
(
p_∑ø
,

34 &(*
µ_moduÀ
)->
c⁄v_weight
[2],

35 
∑th2
,

36 
TRUE
);

37 
	`ªe_check_åue_exô
((
ªtvÆ
 !
ECG_SEG_OK
), 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
, "%†occur†îr‹ whí c⁄°ru˘†weight2", 
__func__
);

38 
ªtvÆ
 |
	`m©_sig_c⁄°ru˘‹_Â_f›í
(
p_∑ø
,

39 &(*
µ_moduÀ
)->
c⁄v_weight
[3],

40 
∑th3
,

41 
TRUE
);

42 
	`ªe_check_åue_exô
((
ªtvÆ
 !
ECG_SEG_OK
), 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
, "%†occur†îr‹ whí c⁄°ru˘†weight3", 
__func__
);

43 
EXIT_CONV_FUSE_RELU_CONSTRUCTOR
:

44 
MODEL_FUNC_EXIT
;

45  
ªtvÆ
;

46 
	}
}

48 
	$c⁄v_fu£_ªlu_de°ru˘‹
(
c⁄v_fu£_ªlu_t
 *
p_moduÀ
)

50 
MODEL_FUNC_ENTRANCE
;

51 
	`ªe_check_nuŒ_exô
(
p_moduÀ
, 
EXIT_CONV_FUSE_RELU_DESTRUCTOR
, "%†dúe˘lyÑëu∫ duêtÿp_moduÀ i†NULL", 
__func__
);

52 
uöt32_t
 
i
 = 0; i<4; i++)

54 
	`m©_sig_de°ru˘‹
(&
p_moduÀ
->
c⁄v_weight
[
i
]);

56 
EXIT_CONV_FUSE_RELU_DESTRUCTOR
:

57 
MODEL_FUNC_EXIT
;

58 
	}
}

	@src/ecg_seg_sig2col.c

1 
	~<°dlib.h
>

2 
	~<°rög.h
>

4 
	~"¨m_ty≥def.h
"

5 
	~"¨m_utû.h
"

6 
	~"ecg_£g_m©rix.h
"

7 
	~"ecg_£g_sig2cﬁ.h
"

8 
	~"ecg_ª•⁄£_def.h
"

9 
	~"ecg_£g_utû.h
"

11 
	$¥öt_sig2cﬁ_˘r_∑øm
(
sig2cﬁ_˘r_t
 *
p_˘r
)

13 
SIG2COL_FUNC_ENTRANCE
;

14 
	`ªe_check_nuŒ_exô
(
p_˘r
, 
EXIT_PRINT_SIG2COL_CTR_PARAM
, "%†occur†îr‹ duêtÿp_˘∏i†NULL", 
__func__
);

15 
	`SIG2COL_PRINTF
("%†p_˘r->cur_out_»%d\n", 
__func__
, 
p_˘r
->
cur_out_l
);

16 
	`SIG2COL_PRINTF
("%†p_˘r->cur_out_∑ck_»%d\n", 
__func__
, 
p_˘r
->
cur_out_∑ck_l
);

17 
	`SIG2COL_PRINTF
("%†p_˘r->cur_k_»%d\n", 
__func__
, 
p_˘r
->
cur_k_l
);

18 
	`SIG2COL_PRINTF
("%†p_˘r->cur_ñe_num %d\n", 
__func__
, 
p_˘r
->
cur_ñe_num
);

19 
	`SIG2COL_PRINTF
("%†p_˘r->max_out_»%d\n", 
__func__
, 
p_˘r
->
max_out_l
);

20 
	`SIG2COL_PRINTF
("%†p_˘r->max_out_∑ck_»%d\n", 
__func__
, 
p_˘r
->
max_out_∑ck_l
);

21 
	`SIG2COL_PRINTF
("%†p_˘r->max_k_»%d\n", 
__func__
, 
p_˘r
->
max_k_l
);

22 
	`SIG2COL_PRINTF
("%†p_˘r->max_ñe_num %d\n", 
__func__
, 
p_˘r
->
max_ñe_num
);

23 
EXIT_PRINT_SIG2COL_CTR_PARAM
:

24 
SIG2COL_FUNC_EXIT
;

25 
	}
}

27 
ölöe
 
	$sig2cﬁ_gë_pixñ_Â
(
uöt32_t
 
sig_öd_w_∑ddög
, 
m©_sig_t
 *
p_m©
)

29 
SIG2COL_FUNC_ENTRANCE
;

30 
„©uª
 = 0.0f;

31 *
p_buf
 = (*)
p_m©
->
‹i_buf
;

32 
öt32_t
 
sig_öd_wo_∑ddög
 = 
sig_öd_w_∑ddög
 - 
p_m©
->
∑ddög
;

33 i‡((
sig_öd_wo_∑ddög
 >0Ë&& (sig_öd_wo_∑ddög < 
p_m©
->
‹i_l
))

35 
	`ªe_log
(
SIG2COL_LOG
, "sig_öd_wo_∑ddög %d %d", 
sig_öd_w_∑ddög
, 
sig_öd_wo_∑ddög
);

36 
„©uª
 = *(
p_buf
+
sig_öd_wo_∑ddög
);

38 
	`ªe_log
(
SIG2COL_LOG
, "%04.4f\n", 
„©uª
);

39 
SIG2COL_FUNC_EXIT
;

40  
„©uª
;

41 
	}
}

43 
	$sig2cﬁ_¥ötf_m©_Â
(
sig2cﬁ_˘r_t
 *
p_˘r
)

45 
SIG2COL_FUNC_ENTRANCE
;

46 *
p_cﬁ_buf
 = 
p_˘r
->
cﬁ_buf
;

47 
uöt32_t
 
cﬁ_h_öd
 = 0; cﬁ_h_öd<
p_˘r
->
cur_k_l
; col_h_ind++)

49 
uöt32_t
 
cﬁ_w_öd
 = 0; cﬁ_w_öd<
p_˘r
->
cur_out_∑ck_l
; col_w_ind++)

51 
	`SIG2COL_PRINTF
("%04.4‡", *
p_cﬁ_buf
);

52 
p_cﬁ_buf
++;

54 
	`SIG2COL_PRINTF
("\n");

57 
SIG2COL_FUNC_EXIT
;

58 
	}
}

60 
öt32_t
 
	$sig2cﬁ_˘r_Â_c⁄°ru˘‹
(
uöt32_t
 
max_out_l
, uöt32_à
max_k_l
, 
sig2cﬁ_˘r_t
 **
µ_˘r
)

62 
SIG2COL_FUNC_ENTRANCE
;

63 
öt32_t
 
ªtvÆ
 = 
ECG_SEG_OK
;

64 
uöt32_t
 
ñe_num
 = 0;

65 
	`ªe_check_nuŒ_exô_ªtvÆ
(
µ_˘r
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIG2COL_CTR_CONTRUCTOR
,

66 "%†occur†îr‹ duêtÿµ_˘∏i†NULL", 
__func__
);

67 
	`ªe_check_åue_exô_ªtvÆ
((*
µ_˘r
 !
NULL
), 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIG2COL_CTR_CONTRUCTOR
,

68 "%†occur†îr‹ duêtÿ*µ_˘∏i†NULL", 
__func__
);

69 *
µ_˘r
 = 
	`ªe_mÆloc
((
sig2cﬁ_˘r_t
));

70 
	`ªe_£t
(*
µ_˘r
, 0, (
sig2cﬁ_˘r_t
));

71 (*
µ_˘r
)->
max_out_l
 = max_out_l;

72 (*
µ_˘r
)->
max_out_∑ck_l
 = (
max_out_l
 / 
FP_PACK_SIZE
 + 1) * FP_PACK_SIZE;

73 (*
µ_˘r
)->
max_k_l
 = max_k_l;

74 (*
µ_˘r
)->
max_ñe_num
 = ((*µ_˘r)->
max_out_∑ck_l
)*((*µ_˘r)->
max_k_l
);

75 
	`¥öt_sig2cﬁ_˘r_∑øm
(*
µ_˘r
);

76 
ñe_num
 = (*
µ_˘r
)->
max_ñe_num
;

77 
	`ªe_log
(
SIG2COL_LOG
, "%†¥ï¨e†tÿÆloˇã %d flﬂtögÖoöàbuf„r", 
__func__
, 
ñe_num
);

78 (*
µ_˘r
)->
cﬁ_buf
 = 
	`ªe_mÆloc
(
ñe_num
*
ELE_FP_SIZE
);

79 
	`ªe_check_nuŒ_exô_ªtvÆ
((*
µ_˘r
)->
cﬁ_buf
, 
ªtvÆ
, 
ECG_SEG_ALLOC_FAILED
, 
EXIT_SIG2COL_CTR_CONTRUCTOR
,

80 "%†occur†îr‹ duêtÿ*µ_˘r->cﬁ_bu‡i†NULL", 
__func__
);

81 
	`ªe_£t
((*
µ_˘r
)->
cﬁ_buf
, 0, 
ñe_num
*
ELE_FP_SIZE
);

82 
EXIT_SIG2COL_CTR_CONTRUCTOR
:

83 
SIG2COL_FUNC_EXIT
;

84  
ªtvÆ
;

85 
	}
}

87 
öt32_t
 
	$sig2cﬁ_m©_Â
(
sig2cﬁ_˘r_t
 *
p_˘r
, 
m©_sig_t
 *
p_m©
)

89 
SIG2COL_FUNC_ENTRANCE
;

90 
öt32_t
 
ªtvÆ
 = 
ECG_SEG_OK
;

91 
uöt32_t
 
ñe_num
 = 0, 
sig_öd_w_∑ddög
 = 0;

92 
„©uª
 = 0.0f;

93 *
p_cﬁ_buf
 = 
NULL
;

94 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_m©
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIG2COL_MAT_FP
,

95 "%†occur†îr‹ duêtÿp_m© i†NULL", 
__func__
);

96 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_˘r
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIG2COL_MAT_FP
,

97 "%†occur†îr‹ duêtÿp_˘∏i†NULL", 
__func__
);

98 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_˘r
->
cﬁ_buf
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIG2COL_MAT_FP
,

99 "%†occur†îr‹ duêtÿp_˘r->cﬁ_bu‡i†NULL", 
__func__
);

100 
p_˘r
->
cur_k_l
 = 
p_m©
->
cﬁ_h
;

101 
p_˘r
->
cur_out_l
 = 
p_m©
->
cﬁ_w
;

102 
p_˘r
->
cur_out_∑ck_l
 = (
p_m©
->
cﬁ_w
 / 
FP_PACK_SIZE
 + 1)*FP_PACK_SIZE;

103 
p_˘r
->
cur_ñe_num
 =Ö_˘r->
cur_k_l
 *Ö_˘r->
cur_out_∑ck_l
;

104 
	`¥öt_sig2cﬁ_˘r_∑øm
(
p_˘r
);

105 
ñe_num
 = 
p_˘r
->
cur_ñe_num
;

106 
p_cﬁ_buf
 = 
p_˘r
->
cﬁ_buf
;

107 
	`ªe_£t
(
p_cﬁ_buf
, 0, 
ñe_num
*
ELE_FP_SIZE
);

109 
uöt32_t
 
cﬁ_h_öd
 = 0; cﬁ_h_öd<
p_˘r
->
cur_k_l
; col_h_ind++)

111 
sig_öd_w_∑ddög
 = 
cﬁ_h_öd
;

112 
uöt32_t
 
cﬁ_w_öd
 = 0; cﬁ_w_öd<
p_˘r
->
cur_out_∑ck_l
; col_w_ind++)

114 i‡(
cﬁ_w_öd
 < 
p_˘r
->
cur_out_l
)

116 
„©uª
 = 
	`sig2cﬁ_gë_pixñ_Â
(
sig_öd_w_∑ddög
, 
p_m©
);

117 *
p_cﬁ_buf
 = 
„©uª
;

118 
sig_öd_w_∑ddög
 +
p_m©
->
°ride
;

120 
p_cﬁ_buf
++;

124 
EXIT_SIG2COL_MAT_FP
:

125 
SIG2COL_FUNC_EXIT
;

126  
ªtvÆ
;

127 
	}
}

129 
	$sig2cﬁ_˘r_de°ru˘‹
(
sig2cﬁ_˘r_t
 *
p_˘r
)

131 
SIG2COL_FUNC_ENTRANCE
;

132 
	`ªe_check_nuŒ_exô
(
p_˘r
, 
EXIT_SIG2COL_CTR_DESTRUCTOR
, "%†occur†îr‹ duêtÿp_˘∏i†NULL", 
__func__
);

133 
	`ªe_‰ì
(
p_˘r
->
cﬁ_buf
);

134 
EXIT_SIG2COL_CTR_DESTRUCTOR
:

135 
SIG2COL_FUNC_EXIT
;

136 
	}
}

	@src/ecg_seg_signal.c

1 
	~<°dlib.h
>

2 
	~<°rög.h
>

4 
	~"¨m_utû.h
"

5 
	~"¨m_ty≥def.h
"

6 
	~"ecg_ª•⁄£_def.h
"

7 
	~"ecg_£g_m©rix.h
"

8 
	~"ecg_£g_sig«l.h
"

10 
öt32_t
 
	$sig«l_c⁄èöî_c⁄°ru˘‹_Â_f›í
(
uöt32_t
 
sig«l_num
,

11 
m©_sig_∑ø_t
 *
p_∑ø
,

12 
sig«l_c⁄èöî_t
 **
µ_c⁄èöî
,

13 **
sig«l_∑th
)

15 
SIGNAL_FUNC_ENTRANCE
;

16 
öt32_t
 
ªtvÆ
 = 
ECG_SEG_OK
;

17 
	`ªe_check_nuŒ_exô_ªtvÆ
(
p_∑ø
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
,

18 "%†occur†îr‹ duêtÿp_∑ø i†NULL", 
__func__
);

19 
	`ªe_check_nuŒ_exô_ªtvÆ
(
µ_c⁄èöî
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
,

20 "%†occur†îr‹ duêtÿµ_c⁄èöî i†NULL", 
__func__
);

21 
	`ªe_check_nuŒ_exô_ªtvÆ
(
sig«l_∑th
, 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
,

22 "%†occur†îr‹ duêtÿsig«l_∑th i†NULL", 
__func__
);

23 
	`ªe_check_åue_exô
((
sig«l_num
 =0), 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
, "%†dúe˘lyÑëu∫†duêtÿsig«l_num =0", 
__func__
);

24 *
µ_c⁄èöî
 = 
	`ªe_mÆloc
((
sig«l_c⁄èöî_t
));

25 
	`ªe_£t
(*
µ_c⁄èöî
, 0, (
sig«l_c⁄èöî_t
));

26 (*
µ_c⁄èöî
)->
sig«l_num
 = signal_num;

27 
	`ªe_log
(
LOG_DEBUG
, "%†sig«l_num %d %d", 
__func__
, (*
µ_c⁄èöî
)->
sig«l_num
, signal_num);

28 (*
µ_c⁄èöî
)->
sig«l
 = 
	`ªe_mÆloc
((
m©_sig_t
)*
sig«l_num
);

30 
uöt32_t
 
i
=0; i<
sig«l_num
; i++)

32 
	`ªe_log
(
SIGNAL_LOG
, "%†sig«»ödex i %d", 
__func__
, 
i
);

33 
	`ªe_check_nuŒ_exô_ªtvÆ
(
sig«l_∑th
[
i
], 
ªtvÆ
, 
ECG_SEG_INVALID_PARAM
, 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
,

34 "%†occur†îr‹ duêtÿsig«l_∑th[i] i†NULL", 
__func__
);

35 
	`ªe_check_nuŒ_exô_ªtvÆ
(&(*
µ_c⁄èöî
)->
sig«l
[
i
], 
ªtvÆ
, 
ECG_SEG_ALLOC_FAILED
, 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
,

36 "%†occur†îr‹ duêtÿ(*µ_c⁄èöî)->sig«l[i] i†NULL", 
__func__
);

37 
	`ªe_log
(
LOG_DEBUG
, "%†sig«l_∑th %s", 
__func__
, 
sig«l_∑th
[
i
]);

38 
	`m©_sig_c⁄°ru˘‹_Â_f›í
(
p_∑ø
, &(*
µ_c⁄èöî
)->
sig«l
[
i
], 
sig«l_∑th
[i], 
FALSE
);

40 
EXIT_SIGNAL_CONTAINER_CONSTRUCTOR_FP_FOPEN
:

41 
SIGNAL_FUNC_EXIT
;

42  
ªtvÆ
;

43 
	}
}

45 
	$sig«l_c⁄èöî_de°ru˘‹
(
sig«l_c⁄èöî_t
 *
p_c⁄èöî
)

47 
SIGNAL_FUNC_ENTRANCE
;

48 
uöt32_t
 
i
 = 0; i<
p_c⁄èöî
->
sig«l_num
; i++)

50 
	`m©_sig_de°ru˘‹
(&
p_c⁄èöî
->
sig«l
[
i
]);

52 
	`ªe_‰ì
(
p_c⁄èöî
->
sig«l
);

53 
SIGNAL_FUNC_EXIT
;

54 
	}
}

	@util/inc/arm_typedef.h

1 #i‚de‡
__ARM_TYPEDEF_H__


2 
	#__ARM_TYPEDEF_H__


	)

4 
	#BOOL
 

	)

5 
	#TRUE
 (1)

	)

6 
	#FALSE
 (0)

	)

	@util/inc/arm_util.h

1 
	~<™droid/log.h
>

2 
	~<¨m_√⁄.h
>

3 #i‚de‡
__ARM_UTIL_H__


4 
	#__ARM_UTIL_H__


	)

6 
	eLOG_LEVEL
 {

7 
	mLOG_VERBOSE
 = 2,

8 
	mLOG_DEBUG
 = 3,

9 
	mLOG_INFO
 = 4,

10 
	mLOG_WARN
 = 5,

11 
	mLOG_ERROR
 = 6,

12 } 
	tLOG_LEVEL_T
;

14 
	#DEFAULT_LOG_LEVEL
 (
LOG_DEBUG
)

	)

16 #ifde‡
__DEBUG__


18 
	#ªe_log
(
LOG_LEVEL
, 
x
...) \

20 i‡(
LOG_LEVEL
 >
DEFAULT_LOG_LEVEL
) { \

21 
LOG_LEVEL
) { \

22 
LOG_VERBOSE
: \

23 
	`__™droid_log_¥öt
(
ANDROID_LOG_WARN
, "ANDROID_IPP", 
x
); \

25 
LOG_DEBUG
: \

26 
	`__™droid_log_¥öt
(
ANDROID_LOG_DEBUG
, "ANRDOID_IPP", 
x
); \

28 
LOG_INFO
: \

29 
	`__™droid_log_¥öt
(
ANDROID_LOG_INFO
, "ANDROID_IPP", 
x
); \

31 
LOG_WARN
: \

32 
	`__™droid_log_¥öt
(
ANDROID_LOG_WARN
, "ANDROID_IPP", 
x
); \

34 
LOG_ERROR
: \

35 
	`__™droid_log_¥öt
(
ANDROID_LOG_ERROR
, "ANRDOID_IPP", 
x
); \

38 
	`¥ötf
(
x
); \

39 
	`¥ötf
("\n"); \

41 }

	)

43 
	#FUNC_ENTRANCE_LOG
 
	`ªe_log
(
LOG_DEBUG
, "%†íãrs", 
__func__
);

	)

44 
	#FUNC_EXIT_LOG
 
	`ªe_log
(
LOG_DEBUG
, "%†Àaves", 
__func__
);

	)

45 
	#ªe_¥ötf
(
LOG_LEVEL
, 
x
...) \

47 i‡(
LOG_LEVEL
 >
DEFAULT_LOG_LEVEL
) { \

48 
	`¥ötf
(
x
); \

50 }

	)

52 
	#ªe_log
(
LOG_LEVEL
, 
x
...Ëdÿ{} 0)

	)

53 
	#FUNC_ENTANGE_LOG
 dÿ{} 0)

	)

54 
	#FUNC_EXIT_LOG
 dÿ{} 0)

	)

55 
	#ªe_¥ötf
(
LOG_LEVEL
, 
x
...Ëdÿ{} 0)

	)

58 #i‚de‡
NULL


59 
	#NULL
 ((*)0)

	)

61 
	#ªe_mÆloc
(
size
Ë
	`mÆloc
(size)

	)

62 
	#ªe_£t
(
d°
, 
vÆue
, 
size
Ë
	`mem£t
(d°, vÆue, size)

	)

63 
	#ªe_˝y
(
d°
, 
§c
, 
size
Ë
	`mem˝y
(d°, src, size)

	)

64 
	#ªe_‰ì
(
§c
) \

66 i‡(
§c
) \

68 
	`‰ì
(
§c
); \

69 
§c
 = 
NULL
; \

71 }

	)

73 
	#ªe_f›í
(
fûe_«me
, 
mode
Ë
	`f›í
(fûe_«me, mode)

	)

74 
	#ªe_f˛o£
(
§c_fûe
) \

76 i‡(
§c_fûe
) \

78 
	`f˛o£
(
§c_fûe
); \

79 
§c_fûe
 = 
NULL
; \

81 }

	)

83 
	#ªe_check_f›í
(
fûe_±r
, 
fûe_«me
, 
mode
, 
EXIT_TAG
) \

85 
fûe_±r
 = 
	`ªe_f›í
(
fûe_«me
, 
mode
); \

86 i‡(!
fûe_±r
) \

88 
	`ªe_log
(
LOG_ERROR
, "%†ˇn'à›í %s", 
__func__
, 
fûe_«me
); \

89 
EXIT_TAG
; \

91 }

	)

93 
	#ªe_fûe_size
(
fûe_size
, 
fûe_±r
) \

95 
	`f£ek
(
fûe_±r
, 0L, 
SEEK_END
); \

96 
fûe_size
 = (
size_t
)
	`·ñl
(
fûe_±r
); \

97 
	`ªe_log
(
LOG_DEBUG
, "%†FILE'†sizêi†%zu", 
__func__
, 
fûe_size
); \

98 
	`ªe_f˛o£
(
fûe_±r
); \

99 }

	)

101 
	#ªe_fûe_ªad
(
fûe_±r
, 
p_buf„r
, 
fûe_size
, 
ªad_size
) \

103 
ªad_size
 = 
	`‰ód
(
p_buf„r
, (), 
fûe_size
, 
fûe_±r
); \

104 
	`ªe_f˛o£
(
fûe_±r
); \

105 
	`ªe_log
(
LOG_DEBUG
, "%†ªad_sizêi†%zu", 
__func__
, 
ªad_size
); \

106 }

	)

108 
	#ªe_fûe_wrôe
(
fûe_±r
, 
p_buf„r
, 
fûe_«me
, 
fûe_size
) \

110 i‡(
fûe_±r
 && 
p_buf„r
) \

112 
	`ªe_log
(
LOG_DEBUG
, "%†ßve†%s", 
__func__
, 
fûe_«me
); \

113 
	`fwrôe
(
p_buf„r
, (
uöt8_t
), 
fûe_size
, 
fûe_±r
); \

114 
	`ªe_f˛o£
(
fûe_±r
); \

117 
	`ªe_log
(
LOG_ERROR
, "%†¥ï¨e†tÿßvê%†Áûed", 
__func__
, 
fûe_«me
); \

119 }

	)

121 
	#ªe_check_nuŒ_exô
(
±r
, 
EXIT_LABEL
, 
ERROR_LOG
, ...) \

123 i‡(!
±r
) { \

124 
	`ªe_log
(
LOG_ERROR
, 
ERROR_LOG
, ##
__VA_ARGS__
); \

125 
EXIT_LABEL
; \

127 }

	)

129 
	#ªe_check_nuŒ_exô_ªtvÆ
(
±r
, 
ªtvÆ
, 
RET_CODE
, 
EXIT_LABEL
, 
ERROR_LOG
, ...) \

131 i‡(!
±r
) { \

132 
ªtvÆ
 = 
RET_CODE
; \

133 
	`ªe_log
(
LOG_ERROR
, 
ERROR_LOG
, ##
__VA_ARGS__
); \

134 
EXIT_LABEL
; \

136 }

	)

138 
	#ªe_check_åue_exô
(
check_v
, 
EXIT_LABEL
, 
ERROR_LOG
, ...) \

140 i‡(
check_v
) { \

141 
	`ªe_log
(
LOG_ERROR
, 
ERROR_LOG
, ##
__VA_ARGS__
); \

142 
EXIT_LABEL
; \

144 }

	)

146 
	#ªe_check_åue_exô_ªtvÆ
(
check_v
, 
ªtv
, 
RET_CODE
, 
EXIT_LABEL
, 
ERROR_LOG
, ...) \

148 i‡(
check_v
) { \

149 
ªtvÆ
 = 
RET_CODE
; \

150 
	`ªe_log
(
LOG_ERROR
, 
ERROR_LOG
, ##
__VA_ARGS__
); \

151 
EXIT_LABEL
; \

153 }

	)

155 
	#REE_UNUSED
 
	`__©åibuã__
((
unu£d
))

	)

157 
now_ns
();

158 
ªe_dbg_√⁄_u32x4_t
(
uöt32x4_t
 
vec_dbg
);

159 
ªe_dbg_√⁄_u32x4x4_t
(
uöt32x4x4_t
 
vec_dbg
);

160 
ªe_dbg_√⁄_Â32x4x4_t
(
Êﬂt32x4x4_t
 
vec_dbg
);

	@util/inc/ecg_response_def.h

1 #i‚de‡
__ECG_SEG_RESPONSE_DEF_H__


2 
	#__ECG_SEG_RESPONSE_DEF_H__


	)

4 
	eecg_£g_ªs
 {

5 
	mECG_SEG_OK
 = 0,

6 
	mECG_SEG_INVALID_PARAM
 = 1,

7 
	mECG_SEG_ALLOC_FAILED
 = 2,

8 } 
	tecg_£g_ªs_t
;

	@util/inc/ecg_seg_util.h

1 #i‚de‡
__ECG_SEG_UTIL_H__


2 
	#__ECG_SEG_UTIL_H__


	)

4 
	#ECG_SEG_PATH_MAX
 (256)

	)

	@util/src/arm_util.c

1 
	~<°dio.h
>

2 
	~<time.h
>

3 
	~<¨m_√⁄.h
>

4 
	~"¨m_utû.h
"

6 
	$now_ns
()

8 
time•ec
 
ªs
;

9 
	`˛ock_gëtime
(
CLOCK_REALTIME
, &
ªs
);

10  1000.0*
ªs
.
tv_£c
 + (Ïes.
tv_n£c
/1e6;

11 
	}
}

13 
	$ªe_dbg_√⁄_u32x4_t
(
uöt32x4_t
 
vec_dbg
)

15 
uöt32_t
 
dbg_buf
[4] = {0};

16 
	`v°1q_u32
(
dbg_buf
, 
vec_dbg
);

17 
	`ªe_log
(
LOG_DEBUG
, "%04d %04d %04d %04d", 
dbg_buf
[0], dbg_buf[1], dbg_buf[2], dbg_buf[3]);

18 
	}
}

20 
	$ªe_dbg_√⁄_u32x4x4_t
(
uöt32x4x4_t
 
vec_dbg
)

22 
uöt32_t
 
dbg_buf
[16] = {0};

23 
	`v°4q_u32
(
dbg_buf
, 
vec_dbg
);

24 
	`ªe_log
(
LOG_DEBUG
, "%04d %04d %04d %04d", 
dbg_buf
[0], dbg_buf[1], dbg_buf[2], dbg_buf[3]);

25 
	`ªe_log
(
LOG_DEBUG
, "%04d %04d %04d %04d", 
dbg_buf
[4], dbg_buf[5], dbg_buf[6], dbg_buf[7]);

26 
	`ªe_log
(
LOG_DEBUG
, "%04d %04d %04d %04d", 
dbg_buf
[8], dbg_buf[9], dbg_buf[10], dbg_buf[11]);

27 
	`ªe_log
(
LOG_DEBUG
, "%04d %04d %04d %04d", 
dbg_buf
[12], dbg_buf[13], dbg_buf[14], dbg_buf[15]);

28 
	}
}

30 
	$ªe_dbg_√⁄_Â32x4x4_t
(
Êﬂt32x4x4_t
 
vec_dbg
)

32 
dbg_buf
[16] = {0.0};

33 
	`v°4q_f32
(
dbg_buf
, 
vec_dbg
);

34 
	`ªe_log
(
LOG_DEBUG
, "%1.1‡%1.1‡%1.1‡%1.1f", 
dbg_buf
[0], dbg_buf[1], dbg_buf[2], dbg_buf[3]);

35 
	`ªe_log
(
LOG_DEBUG
, "%1.1‡%1.1‡%1.1‡%1.1f", 
dbg_buf
[4], dbg_buf[5], dbg_buf[6], dbg_buf[7]);

36 
	`ªe_log
(
LOG_DEBUG
, "%1.1‡%1.1‡%1.1‡%1.1f", 
dbg_buf
[8], dbg_buf[9], dbg_buf[10], dbg_buf[11]);

37 
	`ªe_log
(
LOG_DEBUG
, "%1.1‡%1.1‡%1.1‡%1.1f", 
dbg_buf
[12], dbg_buf[13], dbg_buf[14], dbg_buf[15]);

38 
	}
}

	@
1
.
0
15
320
inc/ecg_seg_def.h
inc/ecg_seg_matrix.h
inc/ecg_seg_model.h
inc/ecg_seg_sig2col.h
inc/ecg_seg_signal.h
src/ecg_seg_main.c
src/ecg_seg_matrix.c
src/ecg_seg_model.c
src/ecg_seg_sig2col.c
src/ecg_seg_signal.c
util/inc/arm_typedef.h
util/inc/arm_util.h
util/inc/ecg_response_def.h
util/inc/ecg_seg_util.h
util/src/arm_util.c
